var express = require("express"),
http = require("http"),
app = express();

var	result = {
	player: "NONE",
	ai: "NONE",
	outcome: "NONE",
	wins:  0,
	losses:  0,
	ties: 0
};

app.use(express.static(__dirname + "/client"));

http.createServer(app).listen(3000);


app.post("/play/rock", function (req, res) {
	checkLogic("rock");
	res.json(result);
	console.log("rock");
	//res.send("rock");

});

app.post("/play/paper", function (req, res) {
	checkLogic("paper");
	res.json(result);
	console.log("paper");

});

app.post("/play/scissor", function (req, res) {
	checkLogic("scissor");
	res.json(result);
	console.log("scissor");

});

app.post("/play/lizard", function (req, res) {
	checkLogic("lizard");
	res.json(result);
	console.log("lizard");

});

app.post("/play/spock", function (req, res) {
	checkLogic("spock");
	res.json(result);
	console.log("spock");

});

app.get("/",function (req, res) {
	res.send("this is the root route!");


});

function checkLogic(playerChoice) {
	var possiblePlay = ["rock", "paper" , "scissor", "lizard", "spock"];
	//https://stackoverflow.com/questions/4550505/getting-random-value-from-an-array
	var aiChoice =  possiblePlay[Math.floor(Math.random() * 5)];  
	result.player = playerChoice;
	result.ai = aiChoice;

	if (aiChoice === playerChoice) {
		result.ties = result.ties + 1;
		result.outcome = "tie";

	} else if (playerChoice === "rock") {
		if (aiChoice === "paper") {
			result.losses = result.losses + 1;
			result.outcome = "lose";

		} else if (aiChoice === "lizard") {
			result.wins = result.wins + 1;
			result.outcome = "win";

		} else if (aiChoice === "spock") {
			result.losses = result.losses + 1;
			result.outcome = "lose";

		} else {
			result.wins = result.wins + 1;
			result.outcome = "win";
		}

	} else if (playerChoice === "paper") {
		if (aiChoice === "rock") {
			result.wins = result.wins + 1;
			result.outcome = "win";

		} else if (aiChoice === "lizard") {
			result.losses = result.losses + 1;
			result.outcome = "lose";

		} else if (aiChoice === "spock") {
			result.wins = result.wins + 1;
			result.outcome = "win";

		} else {
			result.losses = result.losses + 1;
			result.outcome = "lose";
		}

	} else if (playerChoice === "scissor") {
		if (aiChoice === "rock") {
			result.losses = result.losses + 1;
			result.outcome = "lose";

		} else if (aiChoice === "lizard") {
			result.wins = result.wins + 1;
			result.outcome = "win";

		} else if (aiChoice === "spock") {
			result.losses = result.losses + 1;
			result.outcome = "lose";

		} else {
			result.wins = result.wins + 1;
			result.outcome = "win";
		}

	} else if (playerChoice === "lizard") {
		if (aiChoice === "rock") {
			result.losses = result.losses + 1;
			result.outcome = "lose";

		} else if (aiChoice === "scissor") {
			result.losses = result.losses + 1;
			result.outcome = "lose";

		} else if (aiChoice === "spock") {
			result.wins = result.wins + 1;
			result.outcome = "win";

		} else {
			result.wins = result.wins + 1;
			result.outcome = "win";
		}

	} else if (playerChoice === "spock") {
		if (aiChoice === "rock") {
			result.wins = result.wins + 1;
			result.outcome = "win";

		} else if (aiChoice === "lizard") {
			result.losses = result.losses + 1;
			result.outcome = "lose";

		} else if (aiChoice === "scissor") {
			result.wins = result.wins + 1;
			result.outcome = "win";

		} else {
			result.losses = result.losses + 1;
			result.outcome = "lose";
		}

	}

}
